import { BaseService } from "@/core/base.js";
import { NotFoundError } from "@/error.js";
import type { {{entityName}} } from "./model.js";
import type { {{entityName}}Repository } from "./repository.js";

export class {{entityName}}Service extends BaseService {
  constructor(private readonly _repository: {{entityName}}Repository) {
    super("{{entityName}}Service");
  }

  async create(name: string): Promise<{{entityName}}> {
    this.log(`Creating {{moduleName}}: ${name}`);
    return await this._repository.create(name);
  }

  async getById(id: string): Promise<{{entityName}}> {
    const entity = await this._repository.findById(id);

    if (!entity) {
      throw new NotFoundError("{{entityName}} not found");
    }

    return entity;
  }

  async getAll(): Promise<{{entityName}}[]> {
    this.log("Fetching all {{moduleName}}");
    return await this._repository.findAll();
  }

  async update(id: string, data: { name?: string }): Promise<{{entityName}}> {
    const entity = await this._repository.findById(id);

    if (!entity) {
      throw new NotFoundError("{{entityName}} not found");
    }

    this.log(`Updating {{moduleName}}: ${id}`);
    return await this._repository.update(id, data);
  }

  async delete(id: string): Promise<void> {
    const entity = await this._repository.findById(id);

    if (!entity) {
      throw new NotFoundError("{{entityName}} not found");
    }

    this.log(`Deleting {{moduleName}}: ${id}`);
    await this._repository.delete(id);
  }
}
