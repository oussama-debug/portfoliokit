import { Hono } from "hono";
import { Container, type Module } from "@/core/index.js";
import { Supabase{{entityName}}Repository } from "./repositories/supabase.repository.js";
import { {{entityName}}Service } from "./service.js";
import { routes } from "./route.js";
import { env } from "@repo/env";

export class {{entityName}}Module implements Module {
  readonly name = "{{moduleName}}";

  register(container: typeof Container): void {
    // Register repository
    container.register(
      "{{entityName}}Repository",
      () => new Supabase{{entityName}}Repository(env.SUPABASE_URL, env.SUPABASE_ANON_KEY)
    );

    // Register service
    container.register(
      "{{entityName}}Service",
      () => new {{entityName}}Service(container.resolve("{{entityName}}Repository"))
    );
  }

  routes(): Hono {
    return routes;
  }
}
